\section{Background}
\subsection{\citeauthor{prf} PRF}
\begin{construction}[from~\cite{prf}] 
Define the function ensemble $F = \{F_n\}_{n\in N}$.  For every $n$, a key of a function $F_n$ is a tuple, $\langle P,Q,g,\vec{\alpha}\rangle$, 
where $P$ is an $n$-bit prime, $Q$ a prime divisor of $P-1$, $g$ an element of order $Q$ in $\mathbb{Z}_{p}^*$ and $\vec{\alpha}=\langle 
\alpha_0,\alpha_1, \ldots , \alpha_n \rangle$ a uniformly random sequence of $n+1$ elements of $\mathbb{Z}_Q$.  For any $n$-bit input, $x=x_1 x_2 \ldots x_n$, the 
function $f_{P,Q,g,\vec{\alpha}}$ is defined by:
 $$f_{P,Q,g,\vec{\alpha}}(x) = (g^{\alpha_0})^{\prod_{x_i=1}\alpha_i}$$
\end{construction}

\begin{theorem}[Theorem~4.1 of~\cite{prf}]
\label{theorem:naor}
If the DDH-Assumption holds, then for every probabilistic polynomial-time oracle machine $\mathcal{M}$, every constant $\gamma > 0$, and for all but a finite number of $n$'s
$$| Pr[\mathcal{M}^{f_{P,Q,g,\vec{\alpha}}}(P,Q,g)=1] - Pr[\mathcal{M}^{R_{P,Q,g}}(P,Q,g) = 1]| < \frac{1}{n^\gamma} $$
where in the first probability, $f_{P,Q,g,\vec{\alpha}}$ is distributed according to $F_n$, and in the second probability the distribution of $R_{P,Q,g}$ is uniformly chosen in the set of functions with the domain $\{0,1\}^n$ and range $\langle g\rangle$.
\end{theorem}


\fixme{Show that the Naor Reingold/FIPR05 OPRF is not an iterated PRF}

NOTE: for one-sided security, we use the OT-based solution.

\subsection{$\iprf$ and $\ioprf$ Definition}
\begin{definition}[$\iprf$]\label{defiprf}
  For keys $K=(K_1,\ldots,K_\ell)\in\{0,1\}^{\ell\cdot\lambda}$ and
  inputs $x=(x_1\ldots{}x_\ell)\in\{0,1\}^\ell$, an iterated
  pseudo-random function family $\iprf_{K}(x)$ is a sequence of
  function families
  $\iprf_K(x)=(f^1_{K_1}(x_{1}),\ldots,f^\ell_{K_1,\ldots,K_\ell}(x_{1}\ldots{}x_{\ell}))$,
  where each
  $f^i_{K_1,\ldots,K_i}(x_{1}\ldots{}x_{i}):\{0,1\}^{i\cdot\lambda}\times\{0,1\}^{i}\rightarrow{}v_i\in\{0,1\}^\lambda$
  is a pseudo-random function family with key $(K_1,\ldots,K_i)$ from $K$ and
  input $(x_1\ldots{}x_i)$ from $x$.
\end{definition}

\paragraph{Remarks}
An implication of Definition~\ref{defiprf} is that probability
ensemble (family of random variables)
$V_\lambda=(v_1,\ldots,v_\ell)=\iprf_K(x)\in\{0,1\}^{\ell\cdot\lambda}$
is computationally indistinguishable from probability ensemble
$U_\lambda$ describing uniformly random bit strings of length
$\lambda$.

A simple real-world construction for an $\iprf$ is based on variable
length PRFs, such as HMAC, and a collision resistant hash function
$H$. For example, consider
$\iprf_K(x)=(\hmac_{H(K_1)}(x_1),\ldots,\hmac_{H(K_1||\ldots||K_\ell)}(x_1\ldots{}x_\ell))$.


\begin{figure}[tb]
\RestyleAlgo{boxed}
\LinesNumbered
\begin{functionality}[H]
  \tcp{Let $\iprf$ be an iterated pseudo-random function family}
  $S\rightarrow{}\fioprf$: $K$\; \For{$i=1$ {\bf to} {$\ell$} }{
    $R\rightarrow{}\fioprf:x_i$\; $\fioprf\rightarrow{}R: v_i$ such
    that $(v_1,\ldots,v_\ell)=\iprf_K(x_1\ldots{}x_\ell)$\; }
\end{functionality}
\caption{Functionality $\fioprf$\label{idealioprf}}
\end{figure}

\begin{definition}[$\proto$]
  Let $\iprf_K$ be an iterated pseudo-random function family.  An
  iterated \emph{oblivious} pseudo-random function is an $\ell$-round
  probabilistic protocol $\proto$ between a sender $S$ with input key
  $K\in\{0,1\}^{\lambda\cdot\ell}$ and receiver $R$ with input bit
  string $x=(x_1\ldots{}x_\ell)\in\{0,1\}^{\ell}$ with the following
  properties.

  \begin{itemize}
   
  \item Protocol $\proto$ realizes the ideal functionality $\fioprf$
    shown in Figure~\ref{idealioprf}. After $\ell$ rounds, $R$ has
    received $(v_1,\ldots,v_\ell)=\iprf_K(x),|v_i|=\lambda$, from
    $\fioprf$. Sender $S$ receives nothing from $\fioprf$.
  
  \item For all adversaries $\A$ in the real world, there exists a
    simulator $\myS_R$ in the ideal world such that $R$'s view
    $\mathsf{REAL}_{\proto,\A,R}(x,K)$ in the real world is
    computationally indistinguishable from $R$'s view
    $\mathsf{IDEAL}_{\fioprf,\myS_R(x)}(x,K)$ in the ideal world.

  \item For all adversaries $\A$ in the real world, there exists a
    simulator $\myS_S$ in the ideal world such that $S$'s view
    $\mathsf{REAL}_{\proto,\A,S}(K)$ in the real world is
    computationally indistinguishable from $S$'s view
    $\mathsf{IDEAL}_{\fioprf,\myS_S}(K)$ in the ideal world.
\end{itemize}
\end{definition}

The crucial property of $\fioprf$ in contrast to standard $\oprf$s is
that $R$ can oblivious evaluate a PRF a total of $\ell$ times, but not
on arbitrary inputs. In each round $i$, $R$ submits input $x_i$, but
the PRF will be evaluated using $R$'s previous input
$x_1\ldots{}x_{i-1}$ as a prefix.

\todo{Introduce delegatable PRFs}
